---
title: "Cross Sectional data descriptive"
author: "Catherine Rolls"
date: '`r Sys.Date()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r libraries, include=FALSE}

#load libraries

library (data.table)
library (dplyr)
library (e1071)
library (ggplot2)
library (readr)
library(tidyr)
library(scales)
library (forcats)
library (flextable)


```

```{r}
# The following processing steps will create automated table outputs

# Create folder path for Table and Figure results
Table_folder_path <- "../results/tables"
Figure_folder_path <- "../results/figures"


# Function to make table from summary data
make_table <- function(summary_df, table_number, folder_path, title = NULL) {
  
  ft <- summary_df |>
    flextable() |>
    autofit() |>
    theme_vanilla()
  
  save_flextable(ft, table_number, folder_path, title)
  
  ft  # return the table for printing in markdown
}

# Function to save flextable outputs to word

save_flextable <- function(ft, table_number, folder_path, title = NULL) {
  # ensure folder exists
  if (!dir.exists(folder_path)) dir.create(folder_path, recursive = TRUE)
  
  # construct path
  file_name <- paste0("Table_", table_number, ".docx")
  file_path <- file.path(folder_path, file_name)
  
  # start doc
  doc <- read_docx()
  
  # add title (only if provided)
  if (!is.null(title)) {
    full_title <- paste0("Table ", table_number, ": ", title)
    doc <- doc |>
      body_add_par(full_title, style = "Normal") |>
      body_add_par("", style = "Normal")  # blank line
  }
  
  # add the table and save
  doc <- doc |> body_add_flextable(ft)
  print(doc, target = file_path)
  
  message("Saved: ", file_path)
  invisible(file_path)
}
```

Load dataset: This has already had exclusions applied to it, it is a complete case dataset

```{r}
dat <- readRDS("../data_derived/complete_case_dat.Rds")
```

Data set of complete case participants for analysis
```{r}
# Select variables for cross sectional analysis
dat <- dat %>%
  select (
    eid,
    age_education,
    ethnicity,
    SRF,
    Wrist,
    Hip,
    duration_mod_PA,
    num_days_mod_PA,
    duration_vig_PA,
    num_days_vig_PA,
    duration_walk,
    num_day_walk,
    IPAQ,
    MET_mod = cc_MET_mod, 
    mins_wk_mod = cc_mins_wk_mod,
    MET_vig = cc_MET_vig,
   mins_wk_vig =  cc_mins_wk_vig,
   MET_MVPA = cc_MET_MVPA,
   mins_wk_MVPA = cc_mins_wk_MVPA,
    MET_walk = cc_MET_walk,
    mins_wk_walk = cc_mins_wk_walk,
    MET_summed = cc_MET_summed,
    mins_wk_summed = cc_mins_wk_summed,
    MET_mod_derived = MET_mod,
    MET_vig_derived = MET_vig,
    MET_walk_derived = MET_walk,
    MVPA_derived = MVPA,
    summed_MET_all = cc_MET_summed,
   mins_wk_summed = cc_mins_wk_summed,
    date_assess_A0,
    assessment_country,
    age_A0,
    agegp_A0,
    sex,
    qualification,
    tdi,
    WC,
    weight,
    height,
    BMI,
    BMI_category,
    lost_to_fu,
    approx_dob_derived,
  )
```


Create demo table to compare complete cases to full cohort
```{r}
library(table1)
library(flextable)
library(officer)

# Create table1 object
Table_3.0 <- table1(
  ~ age_A0 + ethnicity + tdi + qualification + weight + height + WC + BMI + SRF + Wrist + Hip + IPAQ | sex, 
  data = dat,
  overall = "Total"
)

# Convert table1 to flextable
ft <- flextable::flextable(as.data.frame(Table_3.0))

# Save to Word
doc <- read_docx()
doc <- body_add_flextable(doc, ft)
print(doc, target = file.path(Table_folder_path, "Table 3.0.docx"))


```

# Demographics of dataset
# Age prfile

##### *Age*

Age has already been limited to age 35-65 

```{r}
ggplot(dat, aes(x = age_A0)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Spread of Age in Assessment centre A0",
    x = "Age(years)",
    y = "Count"
  ) +
  theme_minimal()
```

##### *Sex*

```{r sex bar, echo=FALSE}
ggplot(dat, aes(x = sex)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Split of sex in UK Biobank A0",
    x = "Sex",
    y = "Count"
  ) +
  theme_minimal()+
  scale_y_continuous(labels = comma)
```

##### *Ethnicity*
Ethnicity has multiple catagoies in UK Biobank, these have been recoded to groupings that are most relevant to bone health.

Ethnicity was recoded to show the following groupings 
 - 1 = White, 
 - 2 = Asian and British Asian,
 - 3 = Black and Black British,
-  4 = Mixed

```{r ethnicity bar, echo=FALSE}
ggplot(dat, aes(x = ethnicity)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Spread of ethnicity in UK Biobank A0",
    x = "Ethnicity",
    y = "Count"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = comma)
```


## Exposure variables (PA)

Participants were asked about activities undertaken in the last 4 weeks including frequency, intensity and duration. These are reported as raw values. From these a number of derived Metabolic Equivalent Task (MET) minutes of activity were also derived. 

We have added a derived value of mins/wk spent in each activity for use in comparing to the accelerometry data later.

Activity measures (split into moderate, vigorous, walking and summed activity)

- number of days of activity per week
- duration of activity per week
- mins/wk of activity
- MET mins of activity per week


### Treatment of outliers (already applied to the data by UKB)
- For individual catagories of walking, moderate and vig activity exercise was capped at a maximum of 180 minutes a day, allowing a maximum of 21 hours a week (3 hours*7) 
- Extreme outliers where the sum of walking, moderate and vigorous time variables exceeds 960 minutes (16 hours a day) the whole record is excluded from the analysis as unlikely. 

### Missing data
We are using only participants with all of duration and number of days/wk of activity in our main analysis. Those with missing values in either column are considered NA in the MET calculations and mins/wk calculations. This differs to the UKB anaysis where some data is imputed if just duration is missing. We will use this for comparison in the sensitivity analysis.

### Unable to walk
- For those who respond that they were unable to walk instead of removing them they are given a value of 0 under time spent walking.

## Derivation and cutpoints

The full IPAQ calculates total physical activity as a combination of both leisure time PA (LTPA) as well as domains of work and normal activity - as such the resulting median MET-minutes is higher than for participation in LTPA alone. The general public health recommendations of 30 mins of MVPA are relatively low with most adults being able to achieve this regardless of leisure time activity. To look at the health benefits of LTPA higher cut point thresholds are needed for UKB IPAQ data.

#### ***Derived overall measures of Metabolic***

The methods for deriving METs is described in Cassidy S, Chau JY, Catt M, et al Cross-sectional study of diet, physical activity, television viewing and sleep duration in 233â€…110 adults from the UK Biobank; the behavioural phenotype of cardiovascular disease and type 2 diabetesBMJ Open 2016;6:e010038. doi: 10.1136/bmjopen-2015-010038

MET scoring used

- Walking MET - minutes/week = 3.3 * walking minutes * walking days
- Moderate MET - minutes/week = 4.0 * moderate-intensity activity minutes * moderate days
- Vigorous MET - minutes/week = 8.0 * vigorous-intensity activity minutes * vigorous days
- Total physical activity MET-minutes/week = sum of Walking + Moderate_Vigorous MET-minutes/week scores

## Catagories used by UKB

The below are exact quotes taken from page 6 of the IPAQ guidelines provided by UKB (https://biobank.ndph.ox.ac.uk/showcase/refer.cgi?id=540)

### Moderate PA
a) 3 or more days of vigorous intensity activity of at least 20 minutes per day 
*OR*
b) 5 or more days of moderate-intensity activity and/or walking of at least 30 minutes/day
*OR*
c) 5 or more days of any combination of walking, moderate intensity or vigorous intensity activities achieving a minimum Total physical activity of at least 600 MET-minutes/week

### High PA
A separate catagory of high activity is made from the participant meeting the two following crititeria
a) vigorous-intensity activity on at least 3 days achieving a minimum Total physical activity of at least 1500 MET minutes/week
*OR*
b)7 or more days of any combination of walking, moderate-intensity or vigorous-intensity activities achieving a minimum Total physical activity of at least 3000 MET-minutes/week


#### Moderate activity

```{r}
ggplot(dat[!is.na(dat$duration_mod_PA), ], aes(x = duration_mod_PA)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Histogram of Duration of moderate activity",
       x = "Duration (minutes/wk)",
       y = "Count") +
  theme_minimal()
```
```{r}

ggplot(dat, aes(x = num_days_mod_PA)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Number of days moderate PA per week",
    x = "Number of days",
    y = "Count"
  ) +
  theme_minimal()
```
```{r}
hist(dat$MET_mod, 
     main = "Histogram of MET mins/week moderate activity", 
     xlab = "MET mins/week of moderate activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")
```

```{r}
vars <- c( "duration_mod_PA", "num_days_mod_PA","mins_wk_mod", "MET_mod")

PA_summary_sex <- dat %>%
  group_by(sex) %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) 
PA_summary_total <- dat %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) %>%
  mutate(sex = "Total") %>%
  select(sex, everything())  # make sex the first column for consistency

PA_summary <- bind_rows(PA_summary_sex, PA_summary_total) %>%
  pivot_longer(
    -sex,
    names_to = c("Variable", ".value"),
    names_pattern = "^(.*)_(N|Mean|SD|Median|Min|Max|IQR_low|IQR_high)$"
  )


Table_3.1 <-make_table(
  PA_summary,
  table_number = "3.1",
  folder_path = Table_folder_path,
  title = "Summary statistics on moderate activity at baseline"
)

Table_3.1
```

#### Vigorous activity
```{r}
ggplot(dat[!is.na(dat$duration_vig_PA), ], aes(x = duration_vig_PA)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Histogram of Duration of vigorous activity",
       x = "Duration  (minutes/wk)",
       y = "Count") +
  theme_minimal()
```

```{r}

ggplot(dat, aes(x = num_days_vig_PA)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Number of days vigorous PA per week",
    x = "Number of days",
    y = "Count"
  ) +
  theme_minimal()
```

```{r}
hist(dat$MET_mod, 
     main = "Histogram of MET mins/week vigorous activity", 
     xlab = "MET mins/week of vigorous activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")
```

```{r}
vars <- c( "duration_vig_PA", "num_days_vig_PA","mins_wk_vig", "MET_vig")

PA_summary_sex <- dat %>%
  group_by(sex) %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) 
PA_summary_total <- dat %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) %>%
  mutate(sex = "Total") %>%
  select(sex, everything())  # make sex the first column for consistency

PA_summary <- bind_rows(PA_summary_sex, PA_summary_total) %>%
  pivot_longer(
    -sex,
    names_to = c("Variable", ".value"),
    names_pattern = "^(.*)_(N|Mean|SD|Median|Min|Max|IQR_low|IQR_high)$"
  )


Table_3.2 <-make_table(
  PA_summary,
  table_number = "3.2",
  folder_path = Table_folder_path,
  title = "Summary statistics on vigorous activity at baseline"
)

Table_3.2
```


#### Walking behaviour

```{r}
ggplot(dat[!is.na(dat$duration_walk), ], aes(x = duration_walk)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Histogram of Duration of walking",
       x = "Duration Walk (minutes/wk)",
       y = "Count") +
  theme_minimal()
```

```{r}

ggplot(dat, aes(x = num_day_walk)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Number of days walked per week",
    x = "Number of days",
    y = "Count"
  ) +
  theme_minimal()
```

```{r}
hist(dat$MET_walk, 
     main = "Histogram of MET mins/week walking activity", 
     xlab = "MET mins/week of wallking activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")
```

```{r}
vars <- c( "duration_walk", "num_day_walk", "mins_wk_walk", "MET_walk")

PA_summary_sex <- dat %>%
  group_by(sex) %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) 
PA_summary_total <- dat %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) %>%
  mutate(sex = "Total") %>%
  select(sex, everything())  # make sex the first column for consistency

PA_summary <- bind_rows(PA_summary_sex, PA_summary_total) %>%
  pivot_longer(
    -sex,
    names_to = c("Variable", ".value"),
    names_pattern = "^(.*)_(N|Mean|SD|Median|Min|Max|IQR_low|IQR_high)$"
  )


Table_3.3 <-make_table(
  PA_summary,
  table_number = "3.3",
  folder_path = Table_folder_path,
  title = "Summary statistics on walking activity at baseline"
)

Table_3.3
```

All data is skewed, look at whether log transformation helps normalise the data

```{r}
dat <- dat %>%
  mutate(log_MET_mod = log(MET_mod + 1))

ggplot(dat, aes(x = log_MET_mod)) +
  geom_histogram(bins = 50) +
  theme_minimal()
```
```{r}

# 99th percentile and log transformed
# 1. Calculate 99th percentile on raw MET_mod
p99 <- quantile(dat$MET_mod, 0.99, na.rm = TRUE)

# 2. Filter out extreme values
dat <- dat %>%
  filter(MET_mod <= p99)

# 3. Log transform
dat <- dat %>%
  mutate(log_MET_mod = log(MET_mod + 1))

ggplot(dat, aes(x = log_MET_mod)) +
  geom_histogram(bins = 50) +
  theme_minimal()
```
# Log transformed MET_vig and MET_walk

```{r}
dat <- dat %>%
  mutate(log_MET_vig = log(MET_vig + 1))

ggplot(dat, aes(x = log_MET_vig)) +
  geom_histogram(bins = 50) +
  theme_minimal()

dat <- dat %>%
  mutate(log_MET_walk = log(MET_walk + 1))

ggplot(dat, aes(x = log_MET_walk)) +
  geom_histogram(bins = 50) +
  theme_minimal()
```


#### Combined activity

- MVPA
This variable has been derived along with mins/wk in MVPA in order to compare to other published data and the accelerometry data

```{r}

vars <- c( "mins_wk_MVPA", "MET_MVPA")

PA_summary_sex <- dat %>%
  group_by(sex) %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) 
PA_summary_total <- dat %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) %>%
  mutate(sex = "Total") %>%
  select(sex, everything())  # make sex the first column for consistency

PA_summary <- bind_rows(PA_summary_sex, PA_summary_total) %>%
  pivot_longer(
    -sex,
    names_to = c("Variable", ".value"),
    names_pattern = "^(.*)_(N|Mean|SD|Median|Min|Max|IQR_low|IQR_high)$"
  )


Table_3.4 <-make_table(
  PA_summary,
  table_number = "3.4",
  folder_path = Table_folder_path,
  title = "Summary statistics on MVPA baseline"
)

Table_3.4
```
```{r}
hist(dat$MET_walk, 
     main = "Histogram of MET mins/week walking activity", 
     xlab = "MET mins/week of wallking activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")

# log transformed


```

- Summed days activity per week 

Sum of days performing walking, moderate and vigorous activity - question derived from answers to number of days doing each of the following in a week so total of all will add up to more than 7 but cant be over 21.

- Summed MET minutes per week for all activity 

As with the above this is the total amount of time in minutes spent walking, doing vigorous and doing moderate PA. Unlike summed days this should not exceed the total number of minutes in a week

```{r}
hist(dat$MET_MVPA, 
     main = "Histogram of MET mins/week MVPA", 
     xlab = "MET mins/week of MVPA", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")

dat <- dat %>%
  mutate(log_MET_MVPA = log(MET_MVPA + 1))

ggplot(dat, aes(x = log_MET_MVPA)) +
  geom_histogram(bins = 50) +
  theme_minimal()
```
```{r}
hist(dat$mins_wk_MVPA, 
     main = "Histogram of mins/week MVPA", 
     xlab = "mins/week of MVPA", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")

dat <- dat %>%
  mutate(log_mins_wk_MVPA = log(mins_wk_MVPA + 1))

ggplot(dat, aes(x = log_mins_wk_MVPA)) +
  geom_histogram(bins = 50) +
  theme_minimal()
```


```{r}
vars <- c(  "summed_MET_all")

PA_summary_sex <- dat %>%
  group_by(sex) %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) 
PA_summary_total <- dat %>%
  summarise(
    across(
      all_of(vars),
      list(
        N        = ~ sum(!is.na(.)),
        Mean     = ~ round(mean(., na.rm = TRUE),2),
        SD       = ~ round(sd(., na.rm = TRUE),2),
        Median   = ~ round(median(., na.rm = TRUE),2),
        Min      = ~ min(., na.rm = TRUE),
        Max      = ~ max(., na.rm = TRUE),
        IQR_low  = ~ quantile(., 0.25, na.rm = TRUE),
        IQR_high = ~ quantile(., 0.75, na.rm = TRUE)
      ),
      .names = "{.col}_{.fn}"
    )
  ) %>%
  mutate(sex = "Total") %>%
  select(sex, everything())  # make sex the first column for consistency

PA_summary <- bind_rows(PA_summary_sex, PA_summary_total) %>%
  pivot_longer(
    -sex,
    names_to = c("Variable", ".value"),
    names_pattern = "^(.*)_(N|Mean|SD|Median|Min|Max|IQR_low|IQR_high)$"
  )


Table_3.3 <-make_table(
  PA_summary,
  table_number = "3.3",
  folder_path = Table_folder_path,
  title = "Summary statistics on all activity at baseline"
)

Table_3.3
```


```{r MET histo, echo=FALSE}

hist(dat$MVPA, 
     main = "Histogram of summed MET mins/week for all activity", 
     xlab = "MET mins/week of all activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")

hist(dat$summed_MET_all, 
     main = "Histogram of summed MET mins/week for all activity", 
     xlab = "MET mins/week of all activity", 
     ylab = "Frequency", 
     col = "lightblue", 
     border = "black")

```



#### International Physical Activity Questionnaire (IPAQ) group (p22032_i0)
Based on activity frequency, duration and intensity an activity group is derived as being low, moderate or high active.


```{r IPAQ group bar chart, echo=FALSE}
ggplot(dat, aes(x = IPAQ)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(
    title = "Derived IPAQ activity group",
    x = "IPAQ group",
    y = "Count"
  ) +
  theme_minimal() 

```





